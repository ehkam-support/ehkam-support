<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>مساعد إحكام — دعم فني</title>
  <style>
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Naskh Arabic", Tahoma, sans-serif; background:#f6f7fb; color:#111; }
    header { position:sticky; top:0; background:#fff; border-bottom:1px solid #eee; }
    .wrap { max-width: 920px; margin:0 auto; padding: 12px; }
    h1 { margin:0; font-size: 18px; }
    #chat { height: calc(100vh - 210px); overflow-y:auto; padding: 16px 6px 8px; }
    .msg { display:flex; gap:10px; margin:10px 0; align-items:flex-start; }
    .bubble { padding: 10px 14px; border-radius:14px; max-width:85%; line-height:1.7; white-space:pre-wrap; word-wrap:break-word; }
    .user .bubble { background:#0077ff; color:#fff; border-bottom-left-radius:4px; margin-inline-start:auto; }
    .bot  .bubble { background:#fff; border:1px solid #eee; border-bottom-right-radius:4px; }
    .menu { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
    .menu button { border:1px solid #ddd; background:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; font:inherit; }
    .menu button:hover { border-color:#bbb; }
    form { position:sticky; bottom:0; background:#fff; border-top:1px solid #eee; }
    .row { display:flex; gap:8px; align-items:stretch; }
    textarea { flex:1; resize:none; min-height:44px; max-height:140px; padding:10px 12px; border:1px solid #ddd; border-radius:10px; font:inherit; }
    button.send { padding:0 16px; border:1px solid #0077ff; background:#0077ff; color:#fff; border-radius:10px; cursor:pointer; font:inherit; }
    .hint { font-size:12px; color:#666; margin-top:6px; }
    .small { font-size:12px; color:#333; }
    .copyRow { display:flex; gap:8px; margin-top:6px; flex-wrap:wrap; }
    .copyRow button { border:1px solid #ddd; background:#fff; border-radius:8px; padding:6px 10px; cursor:pointer; font:inherit; }
    footer { text-align:center; font-size:12px; color:#888; padding:8px 0 14px; }
    a { color:#0077ff; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>مساعد إحكام — دعم فني</h1>
    </div>
  </header>

  <div class="wrap">
    <div id="chat" aria-live="polite" aria-label="منطقة المحادثة"></div>
  </div>

  <form id="composer" autocomplete="off">
    <div class="wrap">
      <div class="row">
        <textarea id="input" placeholder="اكتب رسالتك هنا (أو اختر من الأزرار) — هذا المساعد ليس ذكاءً اصطناعيًا."></textarea>
        <button class="send" id="send" type="submit">إرسال</button>
      </div>
      <div class="hint">تلميح: اضغط زر من القائمة لعرض الرد الجاهز. لو كتبت نص حر، بيرد عليك بطلب اختيار من القائمة.</div>
    </div>
  </form>

  <footer>
    <div class="wrap">صفحة واحدة — دعم فني ثابت لمنصة إحكام</div>
  </footer>

  <script>
    // ————— الإعدادات (تقدر تعدل النصوص لاحقًا) —————
    const CONTACT_PHONE = "920035544";
    const CONTACT_EMAIL = "info@ehkaam.sa";

    // قائمة الخيارات والردود الثابتة
    const OPTIONS = [
      {
        key: "tamaluk",
        label: "استفسار عن طلب تملك",
        reply: [
          "بالنسبة لاستفسار طلب التملك:",
          "- يمكنك متابعة حالة طلبك عن طريق حسابك في منصة إحكام.",
          "- في حال احتجت مساعدة إضافية، تواصل مع مركز الاتصال الموحد.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      },
      {
        key: "docs",
        label: "بشأن تسليم وثائق مطلوبة منك من منصة إحكام",
        reply: [
          "لتسليم الوثائق المطلوبة:",
          "- يرجى الدخول إلى حسابك في منصة إحكام، وفتح الطلب المحدد، ثم إرفاق الوثائق المطلوبة بصيغة مناسبة وواضحة.",
          "- عند مواجهة أي صعوبة، تواصل مع مركز الاتصال أو عبر البريد الإلكتروني.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      },
      {
        key: "transfer",
        label: "بشأن نقل طلبات من مورث إلى أحد الورثة",
        reply: [
          "بخصوص نقل الطلب من مورّث إلى أحد الورثة:",
          "- يرجى مراجعة بيانات الطلب عبر حساب المنصة والتأكد من اتباع الإرشادات الظاهرة في الطلب.",
          "- للمساعدة والتوضيح حول المتطلبات والإجراءات، تواصل مع مركز الاتصال أو البريد الإلكتروني.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      },
      {
        key: "refund",
        label: "بشأن استرداد رسوم لمستفيدي الضمان الاجتماعي",
        reply: [
          "استرداد الرسوم لمستفيدي الضمان الاجتماعي:",
          "- في حال كانت الشروط منطبقة، يمكنك التقدم بطلب الاسترداد من خلال حسابك في منصة إحكام.",
          "- لأي استفسار إضافي حول الأهلية أو الإجراء، نرجو التواصل.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      },
      {
        key: "processes",
        label: "المعاملات",
        reply: [
          "الخدمات المتعلقة بالمعاملات:",
          "- للاطلاع على المعاملات المرتبطة بحسابك، تفضل بالدخول إلى حسابك في المنصة.",
          "- للمساعدة الفورية بخصوص المعاملات، يمكنك التواصل معنا.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      },
      {
        key: "inq_processes",
        label: "استعلام عن المعاملات",
        reply: [
          "الاستعلام عن المعاملات:",
          "- يرجى إدخال رقم المعاملة في صفحة الاستعلام بحسابك على المنصة.",
          "- إذا تعذر الوصول أو ظهرت مشكلة تقنية، تواصل مع مركز الاتصال أو أرسل بريدًا إلى العنوان التالي.",
          "",
          "مركز الاتصال: " + CONTACT_PHONE,
          "البريد الإلكتروني: " + CONTACT_EMAIL
        ].join("\\n")
      }
    ];

    const WELCOME = [
      "أنا مساعدك بمنصة إحكام.",
      "يسعدني تقديم الخدمات والإجابات على كافة أسئلتك.",
      "ما الخدمة التي تريد الاستفسار عنها؟"
    ].join("\\n");

    // ————— عناصر الصفحة —————
    const chat = document.getElementById("chat");
    const form = document.getElementById("composer");
    const input = document.getElementById("input");
    const sendBtn = document.getElementById("send");

    function el(tag, attrs={}, ...children){
      const e = document.createElement(tag);
      for (const [k,v] of Object.entries(attrs)) {
        if (k === "class") e.className = v;
        else if (k.startsWith("on") && typeof v === "function") e.addEventListener(k.substring(2), v);
        else e.setAttribute(k, v);
      }
      for (const c of children){
        if (c == null) continue;
        if (typeof c === "string") e.appendChild(document.createTextNode(c));
        else e.appendChild(c);
      }
      return e;
    }

    function addBubble(role, text){
      const row = el("div", { class: "msg " + (role === "user" ? "user" : "bot") });
      const bubble = el("div", { class: "bubble" }, text);
      row.appendChild(bubble);
      chat.appendChild(row);
      chat.scrollTop = chat.scrollHeight;
      return row;
    }

    function addMenu(){
      const row = el("div", { class: "msg bot" });
      const bubble = el("div", { class: "bubble" });
      const title = el("div", {}, "الرجاء اختيار خدمة:");
      const menu = el("div", { class: "menu" });

      for (const opt of OPTIONS) {
        const btn = el("button", { onclick: ()=>handleChoice(opt) }, opt.label);
        menu.appendChild(btn);
      }

      // أزرار إضافية
      const extra = el("div", { class: "small", style:"margin-top:8px" }, "معلومات الاتصال:");
      const copyRow = el("div", { class: "copyRow" });
      const btnPhone = el("button", { onclick: ()=>copyText(CONTACT_PHONE) }, "نسخ رقم الاتصال: " + CONTACT_PHONE);
      const btnEmail = el("button", { onclick: ()=>copyText(CONTACT_EMAIL) }, "نسخ البريد: " + CONTACT_EMAIL);
      copyRow.appendChild(btnPhone);
      copyRow.appendChild(btnEmail);

      bubble.appendChild(title);
      bubble.appendChild(menu);
      bubble.appendChild(extra);
      bubble.appendChild(copyRow);

      row.appendChild(bubble);
      chat.appendChild(row);
      chat.scrollTop = chat.scrollHeight;
    }

    function copyText(text){
      navigator.clipboard.writeText(text).then(()=>{
        addBubble("bot", "✅ تم نسخ: " + text);
      }).catch(()=>{
        addBubble("bot", "تعذر النسخ تلقائيًا. انسخها يدويًا: " + text);
      });
    }

    function handleChoice(opt){
      // رسالة المستخدم (اختيار)
      addBubble("user", opt.label);
      // رد ثابت
      addBubble("bot", opt.reply + "\\n\\nهل تحتاج خدمة أخرى؟");
      // أظهر القائمة مجددًا
      addMenu();
    }

    function handleFreeText(txt){
      // بما أن البوت ليس ذكاءً اصطناعيًا، نرجع المستخدم للقائمة
      addBubble("bot", "هذا المساعد يقدم ردودًا جاهزة. يرجى اختيار خدمة من القائمة بالأسفل ⬇️");
      addMenu();
    }

    // إرسال النموذج
    form.addEventListener("submit", (e)=>{
      e.preventDefault();
      const txt = (input.value || "").trim();
      if (!txt) return;
      addBubble("user", txt);
      input.value = "";
      handleFreeText(txt);
    });

    // ترحيب أولي + قائمة
    addBubble("bot", WELCOME);
    addMenu();
  </script>
</body>
</html>